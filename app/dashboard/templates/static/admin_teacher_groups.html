<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Управление группами преподавателей - Teaching Stats</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Подключаем внешние стили -->
    <link rel="stylesheet" href="/templates/static/css/main.css">
    <link rel="stylesheet" href="/templates/static/css/components.css">
    <link rel="stylesheet" href="/templates/static/css/layout.css">
    <link rel="stylesheet" href="/templates/static/css/utils.css">
</head>
<body>
<div class="container" id="main-container">
    <h1>Управление группами преподавателей</h1>

    <form method="GET">
        <label>
            Выберите преподавателя:
            <select name="teacher_id" onchange="this.form.submit()">
                <option value="">-- Выберите преподавателя --</option>
                {{range .TeacherList}}
                <option value="{{.ID}}" {{if eq (printf "%d" .ID) $.SelectedTeacherID}}selected{{end}}>{{.FIO}}</option>
                {{end}}
            </select>
        </label>
    </form>

    {{if .SelectedTeacherID}}
    <h2>Группы преподавателя: {{.SelectedTeacher.FIO}}</h2>

    <div class="btn-group">
        <a href="/admin/groups/add/{{.SelectedTeacher.ID}}" class="btn btn-add">Добавить новую группу</a>
    </div>

    <div class="group-list">
        {{if .Groups}}
        {{range .Groups}}
        <div class="group-item">
            <div class="group-header">
                <div>
                    <span class="group-name">{{.Name}}</span>
                    <span class="student-count">({{.StudentCount}} студентов)</span>
                    <span class="toggle-students" data-container="students-{{.Name}}">Показать/скрыть студентов</span>
                </div>
                <div>
                    <a href="/admin/groups/edit/{{$.SelectedTeacher.ID}}/{{.Name}}" class="btn btn-admin">Редактировать</a>
                </div>
            </div>
            <div id="students-{{.Name}}" class="students-container">
                <ul class="student-list">
                    {{if .Students}}
                    {{range .Students}}
                    <li>{{.FIO}}</li>
                    {{end}}
                    {{else}}
                    <li>Нет студентов в этой группе</li>
                    {{end}}
                </ul>
            </div>
        </div>
        {{end}}
        {{else}}
        <p>У этого преподавателя пока нет групп.</p>
        {{end}}
    </div>
    {{end}}

    <div class="btn-group">
        <a href="/admin" class="btn btn-admin">Назад в админ-панель</a>
    </div>
</div>

<div class="user-info">
    {{if .User.ID}}
    ФИО: {{.User.FIO}} | Роль: {{.User.Role}} | ID: {{.User.ID}}
    {{end}}
</div>

<!-- Подключаем внешние скрипты -->
<script src="/templates/static/js/main.js"></script>
<script src="/templates/static/js/groups.js"></script>
</body>
</html>